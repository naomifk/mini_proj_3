---
title: "Mini_Project_3"
output: html_document
---

```{r, message=FALSE}
#library----
library(tidyverse)
library(sf)
library(macleish)
```

```{r, message=FALSE}
names(macleish_layers)

trails_view <-view(macleish_layers[["trails"]])
contour_30ft_view <- view(macleish_layers[["contours_30ft"]])
contour_3m_view <- view(macleish_layers[["contours_3m"]])
```

```{r}
trails_contour_join<-st_join(trails_view,contour_3m_view,join = st_intersects,left=TRUE)
```

```{r}
trails_grouped  <-trails_contour_join %>%
  group_by(name) %>%
  summarize(N = n(), max_elevation=max(ELEV_FT,na.rm = TRUE),SHAPE_LEN=sum(SHAPE_LEN,na.rm = TRUE),min_elevation=min(ELEV_FT,na.rm = TRUE)) %>% 
  mutate(SHD_number=(sqrt((max_elevation-min_elevation)*2*(SHAPE_LEN*0.000189394))))
```

```{r}
trails_level_function <-function(trail_arg) {
  trails_grouped %>% 
    filter(name==trail_arg)%>%
    select(SHD_number) %>% 
    if(SHD_number<50) {
      return("Easy")
    }
  else if (50<=SHD_number<100) {
    return("Moderate")
  }
  else {
    return("Difficult")
  }
  }
  
```















