---
title: "Mini_Project_3"
output: 
  html_document:
    code_folding: hide
---

```{r, message=FALSE}
#libraries----
library(tidyverse)
library(sf)
library(macleish)
library(leaflet)
```

```{r, message=FALSE}
names(macleish_layers)

trails_view <-view(macleish_layers[["trails"]])
contour_30ft_view <- view(macleish_layers[["contours_30ft"]])
contour_3m_view <- view(macleish_layers[["contours_3m"]])
```

```{r, message=FALSE}
trails_contour_join<-st_join(trails_view,contour_3m_view,join = st_intersects,left=TRUE)
```

```{r, message=FALSE}
trails_grouped  <-trails_contour_join %>%
  group_by(name) %>%
  summarize(N = n(), max_elevation=max(ELEV_FT,na.rm = TRUE),SHAPE_LEN=sum(SHAPE_LEN,na.rm = TRUE),min_elevation=min(ELEV_FT,na.rm = TRUE)) %>% 
  mutate(SHD_number=(sqrt((max_elevation-min_elevation)*2*(SHAPE_LEN*0.000189394))))%>% 
  mutate(difficulty = ifelse(SHD_number < 50, "Easy",
              ifelse(SHD_number < 100, "Moderate", 
              ifelse(SHD_number < 150, "Difficult",
                     "N/A"))))
```


```{r}
pal <- colorFactor(c("#16a027","#FFFF00"),
 trails_grouped %>%
 pull(difficulty) 
 
)
```


```{r}

boundary <- macleish_layers %>%
  pluck("boundary")

trails_inside <- boundary %>%
  st_intersection(trails_grouped)

macleish_map <- leaflet() %>%
  addTiles() %>%
  addPolygons(data = boundary, weight = 1.25, fillColor= "#E4FAFF")

map_color<-macleish_map %>%
  addPolylines(data = contour_3m_view, weight = .5) %>% 
  addPolylines(data = trails_inside,color = ~pal(difficulty))

map_color
```














